const { gray } = require('colorette');
const userConfig = () => {
  try {
    return require('../../customlog.config.js');
  } catch (e) {
    return {}
  }
};
const defaultConfig = require('./config');
const config = { ...defaultConfig, ...userConfig() };

class CustomConsole {
  log(value, ...args) {
    const { printDog, printFlower, printLine,  printArgs, showDogTace, showFlowerTrace } = config;
    const _args = printArgs ? args : [];
    const stackPath = Error().stack.split('\n')[2];
    if(printDog && value.includes('üê∂')) {
      console.log(value, ..._args);
      showDogTace && console.log(gray(stackPath));
    }

    if(printFlower && value.includes('üå∫')) {
      console.log(value, ..._args);
      showFlowerTrace && console.log(gray(stackPath));
    }

    if(printLine && (value.includes('---') || value.includes('==='))) {
      console.log(value);
    }
  }
}

module.exports = new CustomConsole();
